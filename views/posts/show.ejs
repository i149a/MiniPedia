<%- include('../partials/header.ejs') %>

<h2><%= post.title %></h2>
<% if (post.image) { %>
    <img src="<%= post.image %>" alt="<%= post.title %>" width="300" />
<% } %>
<p><%= post.body %></p>

<h3>Tags:</h3>
<ul>
    <% post.tags.forEach(tag => { %>
    <li>
        <a href="/tags/<%= tag._id %>"><%= tag.title %></a>
        
    </li>
    <% }); %>
</ul>

<p>Author: <a href="/users/<%= post.author._id %>"><%= post.author.username %></a></p>
<% if (post.edited) { %>
    <p>Last edited by: <%= post.editors[post.editors.length-1].username %> - Updated at: <%= post.updatedAt %> </p>
    <p>Original post: <a href="/posts/<%= post._id %>/OriginalPost"><%= post.title %></a></p>
<% } %>


<% if ( currentUser == postAuthor) { %>
    <form action="/posts/<%= post._id %>?_method=DELETE" method="POST">
        <button type="submit">Delete</button>
    </form>
<% } %>

<% if ( currentUser ) { %>
    <form action="/posts/<%= post._id %>/edit" method="GET">
        <button type="submit">Edit</button>
    </form>
<% } %>

<%- include('../partials/footer.ejs') %>